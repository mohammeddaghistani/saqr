<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุฅุถุงูุฉ ุณุฌู - ุตูุฑ ุงูุจูุฏ ุงูุฃููู</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="watermark"></div>
    <header>
        <span>๐ ุฅุถุงูุฉ ุณุฌู ุฌุฏูุฏ</span>
        <button onclick="location.href='home.html'" class="btn-gold" style="width:auto; padding:5px 15px;">ุนูุฏุฉ</button>
    </header>

    <div class="container" style="padding:20px; max-width:500px; margin:auto;">
        <div class="glass-card">
            <label>ูุฆุฉ ุงูุนูู</label>
            <select id="category">
                <option>ุนูู ููุฏุงูู</option>
                <option>ุฅูุฌุงุฒ ุฅุฏุงุฑู</option>
                <option>ูููุฉ ุฎุงุตุฉ</option>
            </select>

            <label>ุงููุจูุบ ุงููุฑุชุจุท (ุฅู ูุฌุฏ)</label>
            <input type="number" id="amount" placeholder="0.00">

            <label>ุชูุงุตูู ุงูุนูู</label>
            <textarea id="notes" rows="4" placeholder="ุงูุชุจ ูุตูุงู ูุฎุชุตุฑุงู ูููููุฉ..."></textarea>

            <button class="btn-gold" id="saveBtn" onclick="saveRecord()">ุญูุธ ูุฅุฑุณุงู</button>
        </div>
    </div>

    <script>
        const API = "https://script.google.com/macros/s/AKfycbz70KMwDfxhYukdwfe9bvrMCxJj7zXq0A_uLiJPoTXVU13I9zNqGvGcVk47NWQK6sBW/exec";

        async function saveRecord() {
            const btn = document.getElementById('saveBtn');
            const data = {
                action: 'addRecord',
                empID: sessionStorage.getItem('empID'),
                empName: sessionStorage.getItem('userName'),
                category: document.getElementById('category').value,
                amount: document.getElementById('amount').value,
                notes: document.getElementById('notes').value
            };

            if(!data.notes) return alert("ูุฑุฌู ูุชุงุจุฉ ุงูุชูุงุตูู");

            btn.disabled = true;
            btn.innerText = "ุฌุงุฑู ุงูุญูุธ...";

            try {
                const res = await fetch(API, {
                    method: 'POST',
                    body: JSON.stringify(data)
                }).then(r => r.json());

                if(res.success) {
                    alert("โ ุชู ุงูุญูุธ ุจูุฌุงุญ ุฑูู ุงูุทูุจ: " + res.data.orderID);
                    location.href = 'home.html';
                }
            } catch (e) {
                alert("ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู");
                btn.disabled = false;
                btn.innerText = "ุญูุธ ูุฅุฑุณุงู";
            }
        }
    </script>
</body>
</html>
