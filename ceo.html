<!doctype html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…ÙƒØªØ¨ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© - Ù…Ø¨Ø§Ø¯Ø±Ø© ØµÙ‚Ø±</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="watermark"></div>
    <header>
        <img src="logo.png" class="logo-header">
        <button class="btn-gold" style="width:auto; padding:8px 15px;" onclick="location.href='home.html'">â¬…ï¸ Ø¹ÙˆØ¯Ø©</button>
    </header>
    <div style="padding:25px; max-width:900px; margin:auto;">
        <div class="glass-card">
            <h2 style="color:var(--gold); text-align:center;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù‚ÙŠØ§Ø¯ÙŠ</h2>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin:20px 0; text-align:center;">
                <div style="padding:20px; background:rgba(200,155,60,0.1); border-radius:15px; border:1px solid var(--gold)">
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº</p>
                    <h1 id="total-amt" style="color:var(--gold)">0.00</h1>
                </div>
                <div style="padding:20px; background:rgba(255,255,255,0.05); border-radius:15px; border:1px solid rgba(255,255,255,0.1)">
                    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</p>
                    <h1 id="total-count">0</h1>
                </div>
            </div>
            <canvas id="myChart" style="max-height:300px;"></canvas>
        </div>
    </div>
    <script>
        const API = "https://script.google.com/macros/s/AKfycbzPMNYU_Q0nTlF8OI6Js4NfXbKjre4I5YspWlg8OdJMa7O1_IZiNjZsvqdfjaPsz46o/exec";
        async function load() {
            const res = await fetch(API, {method:'POST', body:JSON.stringify({action:'getStats'})}).then(r=>r.json());
            if(res.success) {
                document.getElementById('total-amt').innerText = res.data.total;
                document.getElementById('total-count').innerText = res.data.count;
                
                new Chart(document.getElementById('myChart'), {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(res.data.categories),
                        datasets: [{ data: Object.values(res.data.categories), backgroundColor: ['#C89B3C', '#0B5F57', '#1a3a37'] }]
                    },
                    options: { plugins: { legend: { labels: { color: '#fff' } } } }
                });
            }
        }
        load();
    </script>
</body>
</html>
