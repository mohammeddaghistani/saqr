<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>لوحة الرقابة - صقر البلد الأمين</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="watermark"></div>
    <header>
        <span>⚖️ نظام الحوكمة والرقابة</span>
        <button onclick="location.href='home.html'" class="btn-gold" style="width:auto; padding:5px 15px;">عودة</button>
    </header>

    <div style="padding:15px;">
        <div class="glass-card" style="overflow-x:auto;">
            <table style="width:100%; text-align:center; color:white; border-collapse:collapse;">
                <thead>
                    <tr style="background:var(--gold); color:black;">
                        <th>الرقم</th>
                        <th>الموظف</th>
                        <th>الفئة</th>
                        <th>المبلغ</th>
                        <th>الحالة</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        const API = "https://script.google.com/macros/s/AKfycbxUEtrWwX2QmEv8w0frUeGuMSOuu46US9f3IMHAez4J-cYhCy-pVFXJaByE78lODw9L/exec";

        async function loadData() {
            try {
                const res = await fetch(`${API}?action=getStats`).then(r => r.json());
                if(res.success) {
                    const tbody = document.getElementById('tableBody');
                    res.data.recentRecords.forEach(rec => {
                        tbody.innerHTML += `
                            <tr style="border-bottom:1px solid rgba(255,255,255,0.1)">
                                <td style="padding:10px;">${rec.id}</td>
                                <td>${rec.emp}</td>
                                <td>${rec.cat}</td>
                                <td>${rec.amt}</td>
                                <td>${rec.status}</td>
                            </tr>`;
                    });
                }
            } catch (e) { alert("فشل جلب البيانات"); }
        }
        loadData();
    </script>
</body>
</html>
